# 研报文件分类管理系统 使用说明

## 系统概述

本系统是一个用于管理和分类研报文件的Python应用程序，主要功能包括：

- 扫描网络盘中的研报文件
- 获取文件详细信息（大小、创建时间、修改时间、访问时间等）
- 筛选今年内有更新的文件
- 提供图形化界面进行手动分类和打标签
- 支持批量上传到MySQL数据库
- 支持Excel文件的导入和导出

## 系统要求

- **操作系统**: Windows 10/11
- **Python版本**: Python 3.6 或更高版本
- **网络要求**: 能够访问网络盘 `\\NAS\study\study`
- **数据库**: MySQL 5.7 或更高版本

## 安装步骤

### 1. 环境准备

确保已安装Python 3.13，并且可以使用 `python` 命令运行。

### 2. 安装依赖

运行安装脚本：
```bash
install.bat
```

或手动安装：
```bash
python -m pip install -r requirements.txt
```

### 3. 配置数据库

编辑 `config.py` 文件，修改数据库连接信息：

```python
DATABASE_CONFIG = {
    'host': '192.168.3.104',
    'port': 3306,
    'user': 'your_username',     # 修改为实际用户名
    'password': 'your_password', # 修改为实际密码
    'database': 'research_reports',
    'charset': 'utf8mb4'
}
```

## 使用方法

### 启动程序

双击运行 `run.bat` 或在命令行执行：
```bash
python main.py
```

### 主要功能操作

#### 1. 扫描文件

1. 点击 **"扫描文件"** 按钮
2. 系统会自动扫描网络盘路径 `\\NAS\study\study`
3. 筛选出今年内有更新的文件
4. 自动生成Excel文件保存扫描结果

#### 2. 文件分类和标签

1. 在左侧文件列表中选择要分类的文件
2. 在右侧详情区域设置：
   - **分类**: 从预定义分类中选择（宏观经济、行业研究、公司研究等）
   - **重要性**: 选择高、中、低
   - **标签**: 输入自定义标签，用逗号分隔
   - **备注**: 添加详细说明
3. 点击 **"保存修改"** 保存设置

#### 3. 数据导入/导出

**导入Excel文件**:
1. 点击 **"导入Excel"** 按钮
2. 选择之前导出的Excel文件
3. 系统会加载文件数据到界面

**导出Excel文件**:
1. 点击 **"导出Excel"** 按钮
2. 选择保存位置和文件名
3. 系统会将当前数据导出为Excel文件

#### 4. 上传到数据库

1. 完成文件分类和标签后
2. 点击 **"上传到数据库"** 按钮
3. 确认上传操作
4. 系统会批量上传数据到MySQL数据库

### 界面说明

#### 左侧区域 - 文件列表
- **搜索框**: 可按文件名、分类、标签等关键词搜索
- **文件树**: 显示文件列表，包含文件名、大小、修改时间、分类、重要性

#### 右侧区域 - 文件详情
- **基本信息**: 显示文件的详细信息
- **分类和标签**: 进行文件分类和标签设置
- **统计信息**: 显示当前数据的统计概况

## 数据库结构

系统会自动创建以下数据表：

### 1. research_files (研报文件信息表)
- `id`: 主键
- `file_name`: 文件名
- `file_path`: 文件完整路径
- `file_size_mb`: 文件大小(MB)
- `extension`: 文件扩展名
- `creation_date`: 创建日期
- `modification_date`: 修改日期
- `access_date`: 访问日期
- `category`: 文件分类
- `importance`: 重要性级别
- `tags`: 标签
- `notes`: 备注
- `upload_date`: 上传时间

### 2. upload_batches (批次上传记录表)
- `id`: 主键
- `batch_name`: 批次名称
- `upload_date`: 上传时间
- `file_count`: 文件数量
- `total_size_mb`: 总大小
- `status`: 状态
- `notes`: 备注

### 3. file_categories (文件分类表)
- `id`: 主键
- `category_name`: 分类名称
- `description`: 分类描述
- `color`: 分类颜色

## 文件分类体系

系统预定义了以下文件分类：

1. **宏观经济** - 宏观经济分析研报
2. **行业研究** - 行业分析研报
3. **公司研究** - 公司分析研报
4. **投资策略** - 投资策略研报
5. **固定收益** - 固定收益研报
6. **量化研究** - 量化分析研报
7. **其他** - 其他类型研报

## 重要性级别

- **高** - 重要文件，需优先处理
- **中** - 一般重要文件
- **低** - 参考文件

## 常见问题

### Q1: 网络盘路径无法访问怎么办？
A1: 请确保：
- 网络连接正常
- 有权限访问 `\\NAS\study\study` 路径
- 路径确实存在

### Q2: 数据库连接失败怎么办？
A2: 请检查：
- 数据库服务器是否运行
- `config.py` 中的连接信息是否正确
- 网络是否能访问数据库服务器
- 用户权限是否足够

### Q3: 依赖包安装失败怎么办？
A3: 尝试：
- 检查网络连接
- 使用国内镜像源：`pip install -i https://pypi.tuna.tsinghua.edu.cn/simple -r requirements.txt`
- 手动安装单个包进行调试

### Q4: 程序运行缓慢怎么办？
A4: 可能原因：
- 网络盘访问速度慢
- 文件数量过多
- 数据库连接延迟高

建议分批处理大量文件。

## 技术支持

如遇到问题，请检查：
1. 控制台输出的错误信息
2. 网络连接状态
3. 数据库连接状态
4. 文件路径权限

## 更新记录

- v1.0.0 - 初始版本
  - 实现文件扫描功能
  - 实现GUI界面
  - 实现数据库存储
  - 实现Excel导入/导出